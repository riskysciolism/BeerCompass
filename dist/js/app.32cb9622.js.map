{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/App.vue","webpack:///./src/components/Compass/Bottle.vue","webpack:///./src/types/Position.ts","webpack:///./src/components/Compass/PositionService.ts","webpack:///./src/components/Compass/CompassService.ts","webpack:///./src/components/Compass/Bottle.vue?602f","webpack:///./src/components/Compass/Bottle.vue?54e3","webpack:///./src/App.vue?3acc","webpack:///./src/App.vue?dfb6","webpack:///./src/registerServiceWorker.ts","webpack:///./src/main.ts"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","jsonpArray","window","oldJsonpFunction","slice","position","class","id","height","latitude","longitude","other","earthRadiusKm","dLat","Position","degreesToRadians","this","dLon","lat1","lat2","a","Math","sin","cos","atan2","sqrt","floor","degrees","PI","sensor","frequency","referenceFrame","sensorObserver","Observable","observer","addEventListener","q","quaternion","alpha","degree","round","next","start","navigator","geolocation","watchPosition","coords","positionService","target","userHeading","getCurrentHeading","userPosition","getLocation","combinedPromises","combineLatest","subscribe","values","targetHeading","CompassService","getAngleFromPositions","needleHeading","vector","calculateVector","angle","getLatitude","getLongitude","props","type","required","setup","compassService","heading","getHeadingToTarget","renderCompass","canvas","document","getElementById","ctx","getContext","img","Image","onload","cache","ih","iw","width","save","clearRect","translate","rotate","drawImage","restore","src","render","components","Bottle","ready","console","log","registered","cached","updatefound","updated","offline","error","App","mount"],"mappings":"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","file":"js/app.32cb9622.js","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t\"app\": 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([0,\"chunk-vendors\"]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","<template>\n  <Bottle :position=\"position\" />\n</template>\n\n<script lang=\"ts\">\n  import { defineComponent } from \"vue\";\n  import Bottle from \"./components/Compass/Bottle.vue\";\n  import { Position } from \"./types/Position\";\n\n  export default defineComponent({\n    name: \"App\",\n    components: {\n      Bottle,\n    },\n    setup() {\n      const position = new Position(49.483877, 8.47194);\n      return { position };\n    },\n  });\n</script>\n\n<style></style>\n","<template>\n  <div class=\"compass\">\n    <canvas id=\"beerCompass\" height=\"250px\"></canvas>\n  </div>\n</template>\n<script lang=\"ts\">\n  import { Position } from \"@/types/Position\";\n  import { defineComponent, onMounted } from \"@vue/runtime-core\";\n  import { CompassService } from \"./CompassService\";\n\n  export default defineComponent({\n    name: \"Bottle\",\n    props: {\n      position: {\n        type: Position,\n        required: true,\n      },\n    },\n    setup(props) {\n      const compassService = new CompassService();\n      const heading = compassService.getHeadingToTarget(props.position);\n\n      function renderCompass() {\n        let canvas = document.getElementById(\n          \"beerCompass\"\n        ) as HTMLCanvasElement;\n        const ctx = canvas.getContext(\"2d\");\n\n        let img = new Image();\n        img.onload = function () {\n          const cache = img;\n          const ih = cache.height;\n          const iw = cache.width;\n\n          heading.subscribe({\n            next(angle) {\n              ctx!.save();\n              ctx!.clearRect(0, 0, canvas.width, canvas.height);\n              ctx!.translate(canvas.width / 2, canvas.height / 2);\n              ctx!.rotate((angle * Math.PI) / 180);\n              ctx!.translate(-(canvas.width / 2), -(canvas.height / 2));\n              ctx!.drawImage(\n                img,\n                canvas.width / 2 - iw / 2,\n                canvas.height / 2 - ih / 2,\n                iw,\n                ih\n              );\n              ctx!.restore();\n            },\n          });\n        };\n\n        //img.src = \"../../assets/beerBottle.png\";\n        img.src =\n          \"https://www.thecarycompany.com/media/catalog/product/3/0/30wlac_1.jpg\";\n        img.height = 300;\n        img.width = 300;\n      }\n\n      onMounted(() => {\n        renderCompass();\n      });\n    },\n  });\n</script>\n<style></style>\n","export class Position {\n  constructor(private latitude: number, private longitude: number) {}\n\n  static degreesToRadians(degrees: number): number {\n    return (degrees * Math.PI) / 180;\n  }\n\n  calculateDistance(other: Position): number {\n    const earthRadiusKm = 6371;\n\n    const dLat = Position.degreesToRadians(other.latitude - this.latitude);\n    const dLon = Position.degreesToRadians(other.longitude - this.longitude);\n\n    const lat1 = Position.degreesToRadians(this.latitude);\n    const lat2 = Position.degreesToRadians(other.latitude);\n\n    const a =\n      Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n      Math.sin(dLon / 2) * Math.sin(dLon / 2) * Math.cos(lat1) * Math.cos(lat2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n\n    // Returns the distance in meters\n    return Math.floor(earthRadiusKm * c);\n  }\n\n  toString(): string {\n    return this.latitude + \", \" + this.longitude;\n  }\n\n  getLongitude(): number {\n    return this.longitude;\n  }\n\n  getLatitude(): number {\n    return this.latitude;\n  }\n}\n","import { Position } from \"../../types/Position\";\nimport { AbsoluteOrientationSensor } from \"motion-sensors-polyfill\";\nimport { Observable } from \"rxjs\";\n\nexport class PositionService {\n  getCurrentHeading(): Observable<number> {\n    const sensor = new AbsoluteOrientationSensor({\n      frequency: 60,\n      referenceFrame: \"screen\",\n    });\n    const sensorObserver = new Observable<number>((observer) => {\n      sensor.addEventListener(\"reading\", () => {\n        const q = sensor.quaternion;\n\n        let alpha =\n          Math.atan2(\n            2 * q[0] * q[1] + 2 * q[2] * q[3],\n            1 - 2 * q[1] * q[1] - 2 * q[2] * q[2]\n          ) *\n          (180 / Math.PI);\n\n        if (alpha < 0) alpha = 360 + alpha;\n        const degree = Math.round(360 - alpha);\n\n        observer.next(degree);\n      });\n    });\n\n    sensor.start();\n    return sensorObserver;\n  }\n\n  getLocation(): Observable<Position> {\n    return new Observable<Position>((observer) => {\n      navigator.geolocation.watchPosition((position) => {\n        observer.next(\n          new Position(position.coords.latitude, position.coords.longitude)\n        );\n      });\n    });\n  }\n}\n","import { Position } from \"../../types/Position\";\nimport { PositionService } from \"./PositionService\";\nimport { combineLatest, Observable } from \"rxjs\";\n\nexport class CompassService {\n  positionService: PositionService;\n\n  constructor() {\n    this.positionService = new PositionService();\n  }\n\n  public getHeadingToTarget(target: Position): Observable<number> {\n    const userHeading: Observable<number> = this.positionService.getCurrentHeading();\n    const userPosition: Observable<Position> = this.positionService.getLocation();\n    const combinedPromises = combineLatest([userHeading, userPosition]);\n\n    return new Observable<number>((observer) => {\n      combinedPromises.subscribe((values) => {\n        const targetHeading: number = CompassService.getAngleFromPositions(\n          values[1],\n          target\n        );\n        let needleHeading = targetHeading - values[0];\n\n        if (needleHeading < 0) needleHeading = 360 + needleHeading;\n        observer.next(needleHeading);\n      });\n    });\n  }\n\n  private static getAngleFromPositions(\n    start: Position,\n    target: Position\n  ): number {\n    const vector: Array<number> = this.calculateVector(start, target);\n    const angle: number = Math.atan2(vector[1], vector[0]);\n    let degrees: number = (180 * angle) / Math.PI;\n    if (degrees < 0) degrees = 360 + degrees;\n    return Math.round(degrees);\n  }\n\n  private static calculateVector(\n    start: Position,\n    target: Position\n  ): Array<number> {\n    return [\n      target.getLatitude() - start.getLatitude(),\n      target.getLongitude() - start.getLongitude(),\n    ];\n  }\n}\n","\n  import { Position } from \"@/types/Position\";\n  import { defineComponent, onMounted } from \"@vue/runtime-core\";\n  import { CompassService } from \"./CompassService\";\n\n  export default defineComponent({\n    name: \"Bottle\",\n    props: {\n      position: {\n        type: Position,\n        required: true,\n      },\n    },\n    setup(props) {\n      const compassService = new CompassService();\n      const heading = compassService.getHeadingToTarget(props.position);\n\n      function renderCompass() {\n        let canvas = document.getElementById(\n          \"beerCompass\"\n        ) as HTMLCanvasElement;\n        const ctx = canvas.getContext(\"2d\");\n\n        let img = new Image();\n        img.onload = function () {\n          const cache = img;\n          const ih = cache.height;\n          const iw = cache.width;\n\n          heading.subscribe({\n            next(angle) {\n              ctx!.save();\n              ctx!.clearRect(0, 0, canvas.width, canvas.height);\n              ctx!.translate(canvas.width / 2, canvas.height / 2);\n              ctx!.rotate((angle * Math.PI) / 180);\n              ctx!.translate(-(canvas.width / 2), -(canvas.height / 2));\n              ctx!.drawImage(\n                img,\n                canvas.width / 2 - iw / 2,\n                canvas.height / 2 - ih / 2,\n                iw,\n                ih\n              );\n              ctx!.restore();\n            },\n          });\n        };\n\n        //img.src = \"../../assets/beerBottle.png\";\n        img.src =\n          \"https://www.thecarycompany.com/media/catalog/product/3/0/30wlac_1.jpg\";\n        img.height = 300;\n        img.width = 300;\n      }\n\n      onMounted(() => {\n        renderCompass();\n      });\n    },\n  });\n","import { render } from \"./Bottle.vue?vue&type=template&id=c0afe942\"\nimport script from \"./Bottle.vue?vue&type=script&lang=ts\"\nexport * from \"./Bottle.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","\n  import { defineComponent } from \"vue\";\n  import Bottle from \"./components/Compass/Bottle.vue\";\n  import { Position } from \"./types/Position\";\n\n  export default defineComponent({\n    name: \"App\",\n    components: {\n      Bottle,\n    },\n    setup() {\n      const position = new Position(49.483877, 8.47194);\n      return { position };\n    },\n  });\n","import { render } from \"./App.vue?vue&type=template&id=ba6d6f36\"\nimport script from \"./App.vue?vue&type=script&lang=ts\"\nexport * from \"./App.vue?vue&type=script&lang=ts\"\nscript.render = render\n\nexport default script","/* eslint-disable no-console */\n\nimport { register } from \"register-service-worker\";\n\nif (process.env.NODE_ENV === \"production\") {\n  register(`${process.env.BASE_URL}service-worker.js`, {\n    ready() {\n      console.log(\n        \"App is being served from cache by a service worker.\\n\" +\n          \"For more details, visit https://goo.gl/AFskqB\"\n      );\n    },\n    registered() {\n      console.log(\"Service worker has been registered.\");\n    },\n    cached() {\n      console.log(\"Content has been cached for offline use.\");\n    },\n    updatefound() {\n      console.log(\"New content is downloading.\");\n    },\n    updated() {\n      console.log(\"New content is available; please refresh.\");\n    },\n    offline() {\n      console.log(\n        \"No internet connection found. App is running in offline mode.\"\n      );\n    },\n    error(error) {\n      console.error(\"Error during service worker registration:\", error);\n    },\n  });\n}\n","import { createApp } from \"vue\";\nimport App from \"./App.vue\";\nimport \"./registerServiceWorker\";\n\ncreateApp(App).mount(\"#app\");\n"],"sourceRoot":""}